<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:munit="http://www.mulesoft.org/schema/mule/munit" xmlns:munit-tools="http://www.mulesoft.org/schema/mule/munit-tools"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xsi:schemaLocation="
		http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
		http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd
		http://www.mulesoft.org/schema/mule/munit-tools  http://www.mulesoft.org/schema/mule/munit-tools/current/mule-munit-tools.xsd">
	<munit:config name="munit-test-suite.xml" />
	<munit:test name="munit-test-suite-munitFlowTest" doc:id="87dccadc-6221-4ae1-a542-f119f4b11259" description="Test">
		<munit:execution >
			<munit:set-event doc:name="Set Event" doc:id="af637b09-969a-4ac2-b05a-52c506588c90" >
				<munit:attributes value='#[{queryParams:{firstname:"manjunath",lastname:"royal"}}]' />
			</munit:set-event>
			<flow-ref doc:name="Flow-ref to munitFlow" doc:id="7967eb6a-8fee-426b-93e1-c9f71369974a" name="munitFlow"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert-equals doc:name="Assert equals" doc:id="e2c7b52c-9c09-4122-b165-85dc8560323f" actual="#[payload.message]" expected='#["my name is manjunathroyal"]' message='#["Expected output not came"]'/>
		</munit:validation>
	</munit:test>
	<munit:test name="assertthat" doc:id="f0aedfac-ae4f-4cc9-b882-8ded70f75707" >
		<munit:execution >
			<munit:set-event doc:name="Set Event" doc:id="39603b25-da34-49ab-8259-85c7de0ed5bd" >
				<munit:attributes value='#[{queryParams:{firstname:"manjunath",lastname:"royal"}}]' />
			</munit:set-event>
			<flow-ref doc:name="Flow Reference" doc:id="2b03fa18-4c8e-465a-aec0-05dcab193ef5" name="munitFlow"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert-that doc:name="Assert that" doc:id="a1479d84-2928-48e6-8e31-2d4c19513e60" expression="#[payload.message]" is='#[MunitTools::equalTo("my name is manjunathroyal")]' message='#["expected output notcame"]'/>
		</munit:validation>
	</munit:test>
	<munit:test name="assertexpression" doc:id="8d6f5e39-b885-4132-8376-5b5f2c01afca" >
		<munit:execution >
			<munit:set-event doc:name="Set Event" doc:id="7e7a0c48-73e3-423b-a914-2b481285a9ae" >
				<munit:attributes value='#[{queryParams:{firstname:"manjunath",lastname:"royal"}}]' />
			</munit:set-event>
			<flow-ref doc:name="Flow Reference" doc:id="a2a2bfc3-5a67-4e7e-8c20-46179f242160" name="munitFlow"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert doc:name="Assert expression" doc:id="44ae87d4-7d1c-4479-93ac-79eae6649085" >
				<munit-tools:that ><![CDATA[#[import * from dw::test::Asserts 
 ---
payload must equalTo({"message":"my name is manjunathroyal"})]]]></munit-tools:that>
			</munit-tools:assert>
		</munit:validation>
	</munit:test>
	<munit:test name="AssertionusingDW" doc:id="e49c8477-e38f-489c-b703-bca03be62b6f" >
		<munit:execution >
			<munit:set-event doc:name="Set Event" doc:id="f422a87f-dad1-4d4d-87f3-650ab48e6ddb" >
				<munit:attributes value='#[{queryParams:{firstname:"manjunath",lastname:"royal"}}]' />
			</munit:set-event>
			<flow-ref doc:name="Flow Reference" doc:id="36df6d14-9a0d-4702-88ed-19055d702e09" name="munitFlow"/>
		</munit:execution>
		<munit:validation>
			<munit-tools:assert doc:name="Assert expression" doc:id="d4d7a69f-9e14-4b55-a732-2e048ae36f1f" >
				<munit-tools:that ><![CDATA[#[%dw 2.0
import Hello::hello
---
hello::main({payload: payload, attributes: attributes, vars: vars})]]]></munit-tools:that>
			</munit-tools:assert>
		</munit:validation>
	</munit:test>
	<munit:test name="dwlin_execution_input" doc:id="5ec11be7-99d6-491c-b19c-9664a0127039" >
		<munit:execution >
			<munit:set-event doc:name="Set Event" doc:id="f4acdb13-f2ea-4d1f-9ac8-fd1a6cbb6d45" >
				<munit:attributes value="#[readUrl('classpath://Hello/hello_input.dwl')]" />
			</munit:set-event>
			<flow-ref doc:name="Flow Reference" doc:id="2f1f339d-1a7b-4f28-8e80-14335d4ffc50" name="munitFlow"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert doc:name="Assert expression" doc:id="a710a5df-6ecf-4020-b928-335b0148575e" >
				<munit-tools:that ><![CDATA[#[%dw 2.0
import Hello::hello
---
hello::main({payload: payload, attributes: attributes, vars: vars})]]]></munit-tools:that>
			</munit-tools:assert>
		</munit:validation>
	</munit:test>
	<munit:test name="munit-test-suiteTest" doc:id="19d85a46-642a-4780-bb52-ff2baa08b9b9" >
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock when" doc:id="7ca065f6-8f27-46ac-9ca2-8dd1f441bb07" processor="db:select">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="d460f45d-4a11-4a66-b772-ed99d1b1bb4e" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value="#[output application/java&#10;---&#10;readUrl('classpath://DB/dboutput.dwl')]" mediaType="application/java" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<munit:set-event doc:name="Set Event" doc:id="0b7189c4-014b-4e70-9365-b5f6face3774" >
				<munit:attributes value="#[readUrl('classpath://DB/input.dwl')]" />
			</munit:set-event>
			<flow-ref doc:name="Flow Reference" doc:id="f30e6a4c-1294-4f76-a675-b4ee74c729c1" name="munitFlow1"/>
		</munit:execution>
		<munit:validation>
			<munit-tools:assert doc:name="Assert expression" doc:id="20faccdc-ae18-4a3e-8d75-beb45e77fbb7" >
				<munit-tools:that ><![CDATA[#[%dw 2.0
import DB::finaloutput
---
finaloutput::main({payload: payload, attributes: attributes, vars: vars})]]]></munit-tools:that>
			</munit-tools:assert>
		</munit:validation>
	</munit:test>
	<munit:test name="munit-test-suiteTest1" doc:id="b4c142ae-13d2-42ed-9243-ed024145261e" >
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock when" doc:id="a66a5df8-dc6a-4302-8fa8-a0f33218a290" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="aba37ea7-44c8-41ac-b731-f4c909c556fa" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value="#[output application/json &#10;--- &#10;readUrl('classpath://Spy/restapiresponse.dwl')]" mediaType="application/json" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:spy doc:name="Spy" doc:id="52e733a1-9d67-4e88-b3fe-46d5a5d96046" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="aba37ea7-44c8-41ac-b731-f4c909c556fa" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:before-call >
					<munit-tools:assert doc:name="Assert expression" doc:id="ef731576-fa67-4f25-8355-b562acb8fda3" >
						<munit-tools:that ><![CDATA[#[%dw 2.0
import Spy::spybeforecall
---
spybeforecall::main({payload: payload, vars: vars, attributes: attributes})]]]></munit-tools:that>
					</munit-tools:assert>
				</munit-tools:before-call>
				<munit-tools:after-call >
					<munit-tools:assert doc:name="Assert expression" doc:id="6a612861-45df-4c10-81c5-0cd8d17541d3" >
						<munit-tools:that ><![CDATA[#[%dw 2.0
import Spy::spyaftercall
---
spyaftercall::main({payload: payload, attributes: attributes, vars: vars})]]]></munit-tools:that>
					</munit-tools:assert>
				</munit-tools:after-call>
			</munit-tools:spy>
		</munit:behavior>
		<munit:execution >
			<munit:set-event doc:name="Set Event" doc:id="7463cfdf-ef5d-48e5-94a1-0aae6f194ac6" >
				<munit:payload value="#[readUrl('classpath://Spy/reqapi.dwl')]" />
			</munit:set-event>
			<flow-ref doc:name="Flow Reference" doc:id="6f60c437-bc38-4169-a732-465192e363da" name="Flow"/>
		</munit:execution>
		<munit:validation>
			<munit-tools:assert doc:name="Assert expression" doc:id="8dba1255-358b-4a02-b1c8-61a28e8849a5" >
				<munit-tools:that ><![CDATA[#[%dw 2.0
import Spy::apiresponse
---
apiresponse::main({payload: payload, vars: vars, attributes: attributes})]]]></munit-tools:that>
			</munit-tools:assert>
			<munit-tools:verify-call doc:name="Verify call" doc:id="37c39458-2c81-46f7-a8bc-72d724a56172" processor="http:request" times="1">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="Request" attributeName="doc:name" />
				</munit-tools:with-attributes>
			</munit-tools:verify-call>
		</munit:validation>
	</munit:test>


</mule>
